///////////////////////////////////////////////////////////////////////
//	File	:	"CSGD_MessageSystem.h"
//
//	Author	:	Keith Morgado
//
//	Purpose	:	Contains the Messaging System for use in my application.
///////////////////////////////////////////////////////////////////////

#pragma once

#include "CMessages.h"
#include <queue>
using std::queue;

typedef void (*MESSAGEPROC)(CBaseMessage *);

class CSGD_MessageSystem
{
	private:
		MESSAGEPROC				m_MsgProc;		//	Pointer to a message proc function.
		queue<CBaseMessage *>	m_MsgQueue;		//	Where we store our messages.
		static CSGD_MessageSystem	*m_pInstance;
		CSGD_MessageSystem()  { m_MsgProc = 0; }
		CSGD_MessageSystem(const CSGD_MessageSystem &ref);
		CSGD_MessageSystem &operator = (const CSGD_MessageSystem &ref);

	public:
		static CSGD_MessageSystem* GetIntance();
		static void DeleteInstance(void);

		~CSGD_MessageSystem() {}

		//////////////////////////////////////////////////////////////////////////////////////////////////////
		// Function: SetMsgProc
		//
		//  Purpose: Set's the function pointer to be used by the message system.
		//////////////////////////////////////////////////////////////////////////////////////////////////////
		void SetMsgProc(MESSAGEPROC msgProc);

		//////////////////////////////////////////////////////////////////////////////////////////////////////
		// Function: SendMsg
		//
		//  Purpose: Puts the message into the queue for processing later on.
		//////////////////////////////////////////////////////////////////////////////////////////////////////
		void SendMsg(CBaseMessage *pMsg);

		//////////////////////////////////////////////////////////////////////////////////////////////////////
		// Function: PostMsg
		//
		//  Purpose: Process the message immediately.
		//////////////////////////////////////////////////////////////////////////////////////////////////////
		void PostMsg(CBaseMessage *pMsg);

		//////////////////////////////////////////////////////////////////////////////////////////////////////
		// Function: ProcessMessages
		//
		//  Purpose: Process all the messages every frame.
		//////////////////////////////////////////////////////////////////////////////////////////////////////
		void ProcessMessages(void);
};